# exploit

- Required:
    
    + This lab contains a blind [OS command injection](https://portswigger.net/web-security/os-command-injection) vulnerability in the feedback function.
    
    The application executes a shell command containing the user-supplied details. The output from the command is not returned in the response.
    
- Goal:
    
    + To solve the lab, exploit the blind OS [command injection](https://portswigger.net/web-security/os-command-injection) vulnerability to cause a 10 second delay.
    
- Step:
- Analysis
    
    +  I start with checking the website. Any type of user input is always worth investigating. Here, I come across a feedback form:
    
    ![exploit%20cf1870682fed40e88332737b27087fbe/image1.png](exploit%20cf1870682fed40e88332737b27087fbe/image1.png)
    
    + Looking at the request in Burp, I see a possible complication, a csrf token.
    
    ![exploit%20cf1870682fed40e88332737b27087fbe/image2.png](exploit%20cf1870682fed40e88332737b27087fbe/image2.png)
    
    + Fortunately, requesting the feedback page multiple times always contains the same token, and even sending the POST request with the feedback repeatedly with Burp Repeater does result in 200 OK responses. This means that the csrf-token is neither generated uniquely for each form nor expires on usage.
    
    + As common with blind injections, the success of the injection must be inferred by a difference in behaviour. This could be a multitude of things:
    
1. Different behaviour of the application based on whether the command was successful or not (e.g. an error message)
2. Timing differences
3. Out-of-band activities that allow us to catch actions performed on the system (e.g. DNS requests)
- The lab description and goal is time based.
    
    + There are multiple ways to introduct time delays on a command prompt, most of which are dependent on the operating system used (e.g. sleep in bash or timeout in Windows cmd). But there is one command that is available on almost any system that can be abused to cause delays: ping
    
    By default, ping send one request immediately, followed by one additional request per second until the specified number is reached.
    
    As target, the target system itself can be used by its localhost IP 127.0.0.1. Sending 10 requests with ping will cause a delay of 9 seconds (first is sent immediately, than 9 times one second waiting)
    
- Forge a payload
    
    + To cause a 10 seconds delay, ping needs to send 11 requests. My guess for best parameter would be email, as this will likely be supplied as individual command line argument. I want to execute the ping regardless of the result status of the command before (which is likely some failure as some arguments may be missing), therefore I enclose the ping command with ;:
    
    ![exploit%20cf1870682fed40e88332737b27087fbe/image3.png](exploit%20cf1870682fed40e88332737b27087fbe/image3.png)
    
    ![exploit%20cf1870682fed40e88332737b27087fbe/image4.png](exploit%20cf1870682fed40e88332737b27087fbe/image4.png)