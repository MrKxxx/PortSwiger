# exploit

- Required:
    
    + This website has an unauthenticated admin panel at /admin, but a front-end system has been configured to block external access to that path. However, the back-end application is built on a framework that supports the X-Original-URL header.
    
- Goal:
    
    + To solve the lab, access the admin panel and delete the user carlos.
    
- Step:
- Analysis:
    
    + The lab description basically states the solution directly. Trying to access the /admin path, the access is denied by a plain json message:
    
    ![exploit%203ec3a982a0a14aa7b9ee915a590c8711/image1.png](exploit%203ec3a982a0a14aa7b9ee915a590c8711/image1.png)
    

> + It means we cannot access on this url. The front-end system has been configured to block external access to that path. However, the back-end application is built on a framework that supports the X-Original-URL header.
> 
> 
> ![exploit%203ec3a982a0a14aa7b9ee915a590c8711/image2.png](exploit%203ec3a982a0a14aa7b9ee915a590c8711/image2.png)
> 

+ It mean the back-end is processing the url from x-original-url. So that we can try something:

![exploit%203ec3a982a0a14aa7b9ee915a590c8711/image3.png](exploit%203ec3a982a0a14aa7b9ee915a590c8711/image3.png)

- It works.

> + Deleting user carlos is now easy by intercepting the request and move the path to the X-Original-URL header. The URL parameters need to remain in the URL as they are not part of the path.
> 
> 
> ![exploit%203ec3a982a0a14aa7b9ee915a590c8711/image4.png](exploit%203ec3a982a0a14aa7b9ee915a590c8711/image4.png)
> 
> + Returning back to the admin panel (modify request again) confirms that the user was deleted and the lab is solved
>