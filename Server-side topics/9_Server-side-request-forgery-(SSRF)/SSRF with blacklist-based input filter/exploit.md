# exploit

Know information:

- Application checks stock availability on an internal system
- Admin interface is available on [http://localhost/admin](http://localhost/admin)
- Two anti-SSRF features are implemented

Goals:

Access the admin panel and delete user carlos

Step:

![exploit%205882281af49540a3b385923de7459ad7/image1.png](exploit%205882281af49540a3b385923de7459ad7/image1.png)

When we click the Check stock, we will have an stockApi. Then we decode the url coding and we have

![exploit%205882281af49540a3b385923de7459ad7/image2.png](exploit%205882281af49540a3b385923de7459ad7/image2.png)

This is the request will sent to be server. Now we need to change the url that the request will sent to be my localhost

![exploit%205882281af49540a3b385923de7459ad7/image3.png](exploit%205882281af49540a3b385923de7459ad7/image3.png)

Now we find what the input is block, maybe localhost or something. So we can try some new input

![exploit%205882281af49540a3b385923de7459ad7/image4.png](exploit%205882281af49540a3b385923de7459ad7/image4.png)

Now we move to the admin page, we insert some thing

![exploit%205882281af49540a3b385923de7459ad7/image5.png](exploit%205882281af49540a3b385923de7459ad7/image5.png)

admin is blocked, now we continue change the url . And we have new input

![exploit%205882281af49540a3b385923de7459ad7/image6.png](exploit%205882281af49540a3b385923de7459ad7/image6.png)

We find keyword delete and then is the result

![exploit%205882281af49540a3b385923de7459ad7/image7.png](exploit%205882281af49540a3b385923de7459ad7/image7.png)

Now we change the url to delete username carlos

![exploit%205882281af49540a3b385923de7459ad7/image8.png](exploit%205882281af49540a3b385923de7459ad7/image8.png)

And then is result. It mean we success

![exploit%205882281af49540a3b385923de7459ad7/image9.png](exploit%205882281af49540a3b385923de7459ad7/image9.png)

Then we copy all of stockApi and paste it in proxy

![exploit%205882281af49540a3b385923de7459ad7/image10.png](exploit%205882281af49540a3b385923de7459ad7/image10.png)

And encode all of url before we send

![exploit%205882281af49540a3b385923de7459ad7/image11.png](exploit%205882281af49540a3b385923de7459ad7/image11.png)

Now we finish.

![exploit%205882281af49540a3b385923de7459ad7/image12.png](exploit%205882281af49540a3b385923de7459ad7/image12.png)